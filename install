#!/bin/bash
#
# Copyright (c) 2013 Eugene Zhuk.
# Use of this source code is governed by the MIT license that can be found
# in the LICENSE file.

PWD=$(which pwd)
LN=$(which ln)

confirm()
{
    while true; do
	read -p "$1" REPLY
	case "$REPLY" in
	    Y|y) return 0 ;;
	    N|n|"") return 1 ;;
	esac
    done
}

for NAME in .*; do
    FILE=$HOME/$NAME
    case $NAME in
	.|..|.git|.gitignore|osx) continue
	    ;;
	*) LINK="Y"
	    if [ -e "$FILE" ]; then
		if ! confirm "'$FILE' already exists. Do you want to replace it anyway? [y/N]: "; then
		    LINK="N"
		fi
	    fi

	    if [ "$LINK" = "Y" ]; then
		echo "Symlinking '$NAME' into '$FILE'"
		$LN -sfFn "$(PWD)/$NAME" $FILE
	    fi
	    ;;
    esac
done
